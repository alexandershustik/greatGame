<script src="phaser.js"></script>
<script src="jquery.min.js"></script>
<script type="text/javascript">
	$(document).bind('touchmove', false);
	var displayWidth = $(window).width();
	var displayHeight = $(window).height();
	var player, ground;
	var left = false;
	var right = false;

	var game = new Phaser.Game(displayWidth, displayHeight, Phaser.AUTO, '', { preload: preload, create: create, update: update });
	function preload(){
		game.load.image('ground', 'assets/ground.png');
		game.load.image('arrow', 'assets/arrowLeft.png');
		game.load.spritesheet('dude', 'assets/dude.png', 130, 220);
	}
	function create(){
		game.physics.startSystem(Phaser.Physics.ARCADE);
		game.stage.backgroundColor = "#baa";
		//var groundLayer = game.add.group();
		//ground = groundLayer.create(0, displayHeight - 100, 'ground');
		ground = game.add.tileSprite(0, displayHeight-100, displayWidth, displayHeight, 'ground');
		player = game.add.sprite(150, game.world.height - 450, 'dude');

		//Ground platform

		//Animation
		player.animations.add('walk', [0, 1, 2, 3, 4, 5], 10, true);

		// Physics
		ground.enableBody = true;
		game.physics.arcade.enable(ground);
		ground.body.immovable = true;
		game.physics.arcade.enable(player);
		player.body.bounce.y = 0.2;
		player.body.gravity.y = 1000;   
		player.body.collideWorldBounds = true;

		// Arrows

	    buttonRight = game.add.button(60, displayHeight - 60, 'arrow', null, this, 0, 1, 0, 1);
	    buttonRight.anchor.setTo(1, 1);
	    buttonRight.angle = 180;
	    buttonRight.fixedToCamera = true;
	    buttonRight.events.onInputOver.add(function(){right=true;});
	    buttonRight.events.onInputOut.add(function(){right=false;});
	    buttonRight.events.onInputDown.add(function(){right=true;});
	    buttonRight.events.onInputUp.add(function(){right=false;});

	    buttonLeft = game.add.button(10, displayHeight - 60, 'arrow', null, this, 0, 1, 0, 1);
	    buttonLeft.fixedToCamera = true;
	    buttonLeft.events.onInputOver.add(function(){left=true;});
	    buttonLeft.events.onInputOut.add(function(){left=false;});
	    buttonLeft.events.onInputDown.add(function(){left=true;});
	    buttonLeft.events.onInputUp.add(function(){left=false;});



	}
	function update(){
 		game.physics.arcade.collide(player, ground);
		// walk player
	    if (player.alive)
	    {
	        player.body.velocity.x = 0;

	        if (left)
	        {
				player.scale.x = -1;
				player.animations.play('walk');
	            player.body.velocity.x = -300;
	        }
	        else if (right)
	        {
	        	player.scale.x = 1;
	        	player.animations.play('walk');
	            player.body.velocity.x = 300;
	        }
	        else
	        {
		        player.animations.stop();
		        player.frame = 0;
		    }
	    }	
	}
</script>
<style>
	body{
		margin: 0;
		padding: 0;
	}
</style>